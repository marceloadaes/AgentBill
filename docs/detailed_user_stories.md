# Detailed User Stories (US001–US020)

The following table expands the first six user stories with additional details such as goals, functional requirements and acceptance criteria.

| Código | Título | Descrição Geral | Objetivos e Benefícios | Requisitos Funcionais Detalhados | Fluxo Principal (Caminho Feliz) | Fluxos Alternativos e Exceções | Requisitos Não Funcionais | Critérios de Aceitação | Notas e Considerações Técnicas |
|---------|---------|----------------|---------------------|----------------------------------|--------------------------------|-------------------------------------------|--------------------------|----------------------------|----------------------------------|
| **US001** | Definir Nome da Planilha para Armazenamento de Contas | Como usuário, quero definir o nome da planilha para armazenar minhas contas, facilitando a organização e identificação dos dados. Se a planilha não existir, ela deve ser criada automaticamente. | - Organização personalizada do armazenamento de contas.<br>- Identificação clara da planilha utilizada.<br>- Redução de ambiguidades na gestão dos dados. | 1. Permitir que o usuário insira um nome personalizado para a planilha.<br>2. Se o campo for deixado em branco, sugerir e utilizar um nome padrão ("Minhas Contas").<br>3. Verificar a existência da planilha com o nome informado.<br>4. Caso a planilha não exista, criá-la automaticamente. | 1. O usuário acessa a interface do Agent Bill.<br>2. Clica na opção para definir o nome da planilha.<br>3. Insere um nome ou deixa o campo vazio.<br>4. O sistema valida a entrada.<br>5. Se vazio, utiliza o nome padrão "Minhas Contas".<br>6. Verifica se a planilha já existe.<br>7. Se não existir, cria a planilha automaticamente.<br>8. Exibe uma confirmação para o usuário. | - Se o usuário inserir um nome que já exista, o sistema poderá solicitar confirmação para usar a planilha existente ou sugerir a criação de uma nova.<br>- Se ocorrer um erro durante a criação, uma mensagem de erro deve ser exibida e uma nova tentativa deve ser permitida. | - Interface simples, intuitiva e responsiva.<br>- Validação e criação da planilha devem ocorrer rapidamente.<br>- Segurança e integridade dos dados.<br>- Compatibilidade com a API do Google Sheets. | - O sistema deve permitir a inserção de um nome para a planilha.<br>- Se o usuário não inserir um nome, o padrão "Minhas Contas" é utilizado.<br>- A planilha deve ser criada automaticamente se não existir.<br>- Feedback claro e imediato ao usuário sobre a ação realizada. | - Implementar a validação no cliente e no servidor.<br>- Gerenciar erros de autenticação com a API do Google Sheets.<br>- Permitir apenas usuários autenticados via Google OAuth.<br>- Realizar testes para cenários como nome vazio, nome existente e falhas de criação. |
| **US002** | Visualização Dinâmica da Planilha | Como usuário, quero visualizar o conteúdo da planilha para acompanhar quais contas já foram adicionadas, garantindo uma visão atualizada sempre que a planilha for exibida. | - A lista deve ser atualizada em tempo real.<br>- A planilha pode ficar oculta em outras páginas, mas ao ser exibida deve refletir imediatamente as alterações. | 1. Exibir a planilha ou um link para visualização.<br>2. Atualizar os dados automaticamente quando a planilha estiver visível. | 1. Usuário abre a seção da planilha.<br>2. Sistema mostra dados atuais sem recarregar.<br>3. Se houver mudança, atualizar em tempo real. | - Falha de atualização mostra aviso e opção de recarregar. | - Interface responsiva e leve. | - Planilha reflete sempre o estado mais recente quando visualizada. | - Uso de API Routes do Next.js para buscar dados periodicamente. |
| **US003** | Prevenção de Duplicação de Contas | Esta funcionalidade permite que o sistema verifique se uma conta já existe comparando código de barras e data de vencimento. | - Antes de salvar, procurar registro com o mesmo código de barras e vencimento.<br>- Se já existir, exibir notificação e não duplicar. | 1. Após extração, pesquisar na planilha por código de barras e data.<br>2. Se não houver resultado, permitir adicionar a nova conta. | 1. Conta inédita: adiciona e confirma ao usuário.<br>2. Conta duplicada: exibe alerta e cancela inclusão. | - Falha na verificação mostra mensagem de erro. | - Processamento rápido para planilhas grandes. | - Planilha sem registros duplicados. | - Implementar busca otimizada utilizando API Routes do Next.js. |
| **US004** | Seleção de Arquivo para Processamento de Conta | Como usuário, desejo selecionar um arquivo (imagem ou PDF) a partir do meu computador para que o Agent Bill processe os dados da conta contida no arquivo. Essa funcionalidade é essencial para a extração automática de informações de boletos e faturas. | - Facilitar a entrada de dados por meio de arquivos digitalizados.<br>- Integrar a seleção ao fluxo de extração de dados, reduzindo erros.<br>- Garantir uma experiência de usuário intuitiva. | 1. Interface deve ter botão "Selecionar Arquivo" abrindo o seletor do sistema.<br>2. Aceitar apenas arquivos PNG, JPG e PDF, validando imediatamente o formato.<br>3. Após validação, enviar o arquivo para a API OpenAI Vision e exibir mensagem "Processando arquivo".<br>4. Tratar erros: formato inválido gera aviso; cancelamento de seleção não inicia processo. | 1. Usuário clica em "Selecionar Arquivo".<br>2. Seleciona um arquivo PNG, JPG ou PDF.<br>3. O sistema valida e envia para a API.<br>4. O usuário é informado que o arquivo está sendo processado.<br>5. O fluxo continua até a extração e confirmação dos dados. | 1. Formato inválido: exibir mensagem e permitir nova tentativa.<br>2. Cancelamento da operação: retornar à interface principal sem validar ou enviar o arquivo. | - Interface intuitiva e responsiva.<br>- Validação rápida do formato do arquivo.<br>- Envios para a API otimizados.<br>- Transmissão segura dos arquivos. | - O sistema deve aceitar apenas PNG, JPG e PDF.<br>- Em formato inválido, mostrar erro claro com os formatos suportados.<br>- Após um arquivo válido ser escolhido, exibir feedback visual de processamento.<br>- O arquivo deve ser enviado para a API OpenAI Vision para extração dos dados. | - Validar formato no cliente e no servidor.<br>- Testar em diferentes navegadores e dispositivos.<br>- Mensagens claras devem orientar o usuário em cada etapa.<br>- Integração com a API de extração e Google Sheets deve ser testada com atenção. |
| **US005** | Extração Automática de Informações da Conta | Como usuário, quero que o agente extraia automaticamente os dados da conta a partir do arquivo selecionado (imagem ou PDF), evitando digitação manual. | - Automatizar a captura de dados de boletos e faturas.<br>- Reduzir erros e tempo de processamento.<br>- Integrar os dados extraídos com a planilha e calendário. | 1. Enviar o arquivo para a API OpenAI Vision.<br>2. Extrair nome da conta, cedente, tipo, valor, data de vencimento e código de barras.<br>3. Solicitar confirmação manual caso algum dado esteja ilegível ou ausente. | 1. Usuário seleciona o arquivo da conta.<br>2. O sistema envia para a API e aguarda resposta.<br>3. Os dados extraídos são apresentados para revisão.<br>4. Usuário confirma para prosseguir com as próximas etapas. | - Dados faltando: o sistema marca campos faltantes e solicita preenchimento manual.<br>- Erro na API: exibir mensagem e permitir nova tentativa ou escolha de outro arquivo. | - Processamento deve ocorrer em poucos segundos.<br>- Segurança no envio e armazenamento dos dados.<br>- Compatível com arquivos variados em tamanho e qualidade. | - O sistema retorna todos os campos extraídos ou indica claramente os que precisam de correção.<br>- O usuário consegue editar manualmente dados faltantes.<br>- Após confirmação, os dados seguem para validação de duplicidade (US003). | - A integração com OpenAI Vision deve ser implementada em API Routes do Next.js.<br>- Logs de falha de extração devem ser registrados em planilha dedicada.<br>- Considerar tratamento de caracteres especiais e formatações. |
| **US006** | Confirmação Manual dos Dados Extraídos | Como usuário, quero visualizar e editar os dados extraídos antes de confirmá-los para que apenas informações corretas sejam salvas na planilha. | - Garantir que os dados sejam revisados antes do armazenamento.<br>- Permitir correção de erros de OCR.<br>- Aumentar a confiança do usuário no sistema. | 1. Exibir um formulário de revisão após a extração automática.<br>2. Permitir edição de todos os campos (nome, cedente, tipo, valor, vencimento e código de barras).<br>3. Validar os campos editados (formatos, valores, campos obrigatórios).<br>4. Disponibilizar botões para Confirmar ou Cancelar. | 1. A extração é concluída.<br>2. O sistema mostra os dados em tela.<br>3. O usuário revisa e, se necessário, edita campos.<br>4. Clica em Confirmar para prosseguir. | - Usuário cancela a operação: dados extraídos são descartados.<br>- Edição com campos inválidos exibe mensagem de erro e impede confirmação. | - Feedback visual imediato durante a edição.<br>- Interface intuitiva e responsiva.<br>- Tempo de resposta baixo entre edições e confirmação. | - Após a extração, o usuário sempre visualiza um resumo dos dados.<br>- É possível editar qualquer campo antes de confirmar.<br>- Se confirmado, o sistema segue para a verificação de duplicidade (US003). | - Formulário implementado na aplicação Next.js.<br>- Validações adicionais no backend usando API Routes.<br>- Alterações manuais devem ser registradas em log. |
| **US008** | Organização das Informações na Planilha | Como usuário, quero que as informações inseridas sejam distribuídas em colunas apropriadas para cada campo. | - Facilitar a leitura e análise das contas.<br>- Padronizar o formato de inserção. | 1. Definir colunas fixas para nome, cedente, tipo, valor, vencimento e código de barras.<br>2. Inserir novas contas na primeira linha vazia da planilha.<br>3. Manter a ordem das colunas em todas as inserções. | 1. Usuário confirma os dados da conta.<br>2. O sistema localiza a primeira linha vazia.<br>3. Preenche cada coluna com o valor correspondente.<br>4. Salva a planilha. | - Se a estrutura da planilha estiver diferente, exibir mensagem para o administrador corrigir.<br>- Falha ao salvar deve permitir nova tentativa. | - Compatibilidade com Google Sheets.<br>- Manter o formato independentemente do dispositivo do usuário. | - Dados aparecem nas colunas corretas após a inclusão.<br>- Estrutura da planilha permanece intacta.<br>- Mensagem de sucesso apresentada ao finalizar. | - Garantir que mudanças manuais na planilha não quebrem o script.<br>- Usar validações de cabeçalho antes de inserir. |
| **US009** | Criação de Evento no Google Calendar | Como usuário, desejo que seja criado um evento no Google Calendar para lembrar do pagamento. | - O evento deve ser criado automaticamente e incluir no título ou descrição o nome da conta, valor, vencimento e código de barras.<br>- Configurar lembrete para 1 dia antes do vencimento. | 1. Após adicionar a conta, enviar dados ao Calendar e criar o evento.<br>2. Guardar o ID do evento na planilha. | 1. Criação bem-sucedida retorna confirmação ao usuário. | - Falha na comunicação gera aviso e registro no log. | - Integração rápida com a conta Google do usuário. | - Evento contém informações completas e lembrete correto. | - Utilizar API Routes do Next.js para comunicação com a API do Calendar. |
| **US010** | Prevenção de Eventos Duplicados | Como usuário, quero que o agente evite criar eventos duplicados no Google Calendar. | - Antes de criar um evento, o agente deve verificar se já existe um evento com o mesmo código de barras e data de vencimento.<br>- Se encontrado, avisar o usuário e não criar novo. | 1. Ao solicitar a criação, buscar no Calendar por código de barras e vencimento.<br>2. Se não houver resultado, prosseguir com a criação. | 1. Evento já existente: sistema informa e cancela criação.<br>2. Evento inexistente: cria e confirma ao usuário. | - Falhas na consulta devem ser comunicadas. | - Operação rápida e dentro das cotas da API. | - Calendário permanece sem eventos duplicados. | - Registrar ID do evento para consultas futuras. |
| **US011** | Acesso ao Agente por Interface Web | Como usuário, quero acessar o agente por uma interface web disponível em qualquer dispositivo. | - Usar uma aplicação Next.js hospedada na Vercel como ponto central de acesso.<br>- Permitir uso em desktop e dispositivos móveis. | 1. Disponibilizar página na aplicação Next.js com os recursos principais (upload de arquivo, visualização da planilha, status de contas).<br>2. Garantir autenticação antes do uso.<br>3. Exibir mensagens de progresso e resultado das ações. | 1. Usuário abre o site do agente.<br>2. Realiza login com sua conta Google.<br>3. Navega pelas funções e envia arquivos quando necessário. | - Se o usuário não estiver autenticado, redirecionar para a tela de login.<br>- Problemas de carregamento exibem erro amigável. | - Interface responsiva e simples.<br>- Compatível com navegadores modernos. | - Todas as funções principais são acessíveis pelo site.<br>- Interface funciona em diferentes tamanhos de tela.<br>- Acesso restrito a usuários logados. | - Backend implementado com API Routes.<br>- Seguir práticas de segurança do Next.js. |
| **US012** | Layout Intuitivo e Responsivo | Como usuário, quero que a interface se adapte a diferentes telas e seja fácil de usar. | - Melhor experiência para todos os dispositivos.<br>- Navegação simples e objetiva. | 1. Utilizar design responsivo na aplicação Next.js.<br>2. Posicionar botões e formulários de forma clara.<br>3. Validar visualização em desktop e mobile. | 1. Usuário acessa o site em qualquer dispositivo.<br>2. Elementos se ajustam automaticamente.<br>3. Todas as ações permanecem acessíveis. | - Caso elementos não sejam exibidos corretamente, mostrar aviso sugerindo uso de navegador compatível.<br>- Erros de layout devem ser registrados. | - Compatibilidade cross-browser.<br>- Carregamento rápido mesmo em conexões lentas. | - Site se adapta sem quebrar layout.<br>- Botões e campos são fáceis de identificar.<br>- Não há perda de funcionalidade em telas menores. | - Utilizar componentes responsivos do Next.js.<br>- Testar em diferentes navegadores e dispositivos. |
| **US013** | Autenticação Obrigatória com Conta Google | Como usuário, quero que o sistema exija login com minha conta Google antes de utilizar o agente. | - Proteger dados e ações do agente.<br>- Garantir que somente usuários autorizados tenham acesso. | 1. Integrar fluxo de login Google OAuth.<br>2. Bloquear qualquer funcionalidade até que o usuário esteja autenticado.<br>3. Associar registros da planilha e do calendário ao usuário logado. | 1. Usuário acessa o site e é redirecionado para login Google se não estiver autenticado.<br>2. Após o login, volta para o site com permissão de uso.<br>3. Executa as funcionalidades normalmente. | - Tentativa de acesso sem login exibe mensagem solicitando autenticação.<br>- Erros no processo de OAuth são tratados e informados. | - Segurança na troca de tokens.<br>- Conformidade com políticas do Google. | - Nenhuma função é executável sem login.<br>- Usuário autenticado consegue operar normalmente.<br>- Informações manipuladas ficam vinculadas a ele. | - Guardar tokens de forma segura no API Routes do Next.js.<br>- Revisar períodos de expiração e renovação. |
| **US014** | Registro de Logs das Ações | Como usuário, quero que o agente registre logs sempre que uma ação importante ocorrer. | - Possibilitar auditoria das operações.<br>- Acompanhar histórico de execuções. | 1. Registrar no Google Sheets toda vez que um arquivo for processado ou um evento criado.<br>2. Armazenar data, usuário e descrição da ação.<br>3. Disponibilizar visualização desses logs. | 1. Ao processar um arquivo ou criar evento, o sistema grava uma linha na planilha de logs.<br>2. Usuário pode abrir a aba de logs para verificar histórico.<br>3. Log pode ser filtrado por data ou usuário. | - Falha ao gravar log não impede a ação principal, mas deve avisar o usuário.<br>- Planilha de logs cheia exige criação de nova aba ou limpeza. | - Armazenamento deve suportar grande volume de registros.<br>- Acesso restrito apenas a administradores. | - Toda ação relevante gera um registro de log.<br>- Usuário consegue consultar logs quando autorizado.<br>- Mensagens de erro aparecem se gravação falhar. | - Implementar planilha específica para logs.<br>- Controlar tamanho para não exceder limites do Google Sheets. |
| **US015** | Histórico de Arquivos Enviados | Como usuário, quero visualizar um histórico dos arquivos que já enviei. | - Permitir rastrear o que foi processado.<br>- Possibilidade de remover registros do histórico sem apagar dados da planilha principal. | 1. Registrar nome, data e status de cada arquivo.<br>2. Exibir lista de arquivos processados em seção dedicada.<br>3. Oferecer opção de excluir apenas o registro de histórico. | 1. Usuário acessa a área de histórico.<br>2. Visualiza tabela de envios anteriores.<br>3. Remove registros indesejados. | - Exclusão não altera a planilha principal.<br>- Aviso caso o item não exista mais. | - Interface simples e segura. | - Histórico sempre apresenta os arquivos processados, com possibilidade de limpeza controlada. | - Implementar em aba separada do Google Sheets. |
| **US016** | Notificação de Arquivo Ilegível | Como usuário, quero ser informado caso o arquivo enviado não possa ser lido adequadamente. | - Agilizar correção de problemas de leitura.<br>- Evitar salvar dados incompletos. | 1. Detectar erros ou baixa confiabilidade retornada pela API de visão.<br>2. Exibir alerta ao usuário solicitando novo envio ou correção manual.<br>3. Registrar tentativa falha no log. | 1. Arquivo é processado pela API.<br>2. Se a resposta indicar erro ou baixa confiabilidade, o sistema mostra notificação.<br>3. Usuário decide reenviar ou editar manualmente. | - Caso o problema persista, o processo é cancelado e marcado como pendente.<br>- Falha na comunicação com a API também gera alerta. | - Mensagens devem ser claras e objetivas.<br>- Tratamento de erros sem travar a aplicação. | - Usuário recebe aviso imediato quando o arquivo não é lido.<br>- Registro da falha fica disponível em log.<br>- Possibilidade de nova tentativa é oferecida. | - Avaliar grau de confiança da API OpenAI Vision.<br>- Implementar mecanismo de reprocessamento. |
| **US018** | Exibição do Status das Contas | Como usuário, quero que a aplicação exiba uma tabela com o status das minhas contas. | - Visualizar rapidamente contas pagas, vencidas e pendentes.<br>- Facilitar controle financeiro. | 1. Ler informações da planilha principal e agrupar por status.<br>2. Permitir filtros para cada categoria.<br>3. Atualizar a tabela sempre que uma conta for adicionada ou marcada como paga. | 1. Usuário abre a página de status.<br>2. Sistema carrega tabela com todas as contas e seus respectivos estados.<br>3. Usuário pode filtrar ou ordenar conforme necessidade. | - Falha na leitura da planilha exibe mensagem de erro.<br>- Em caso de grande volume, implementar paginação. | - Desempenho adequado mesmo com muitas linhas.<br>- Visualização compatível com dispositivos móveis. | - Tabela mostra corretamente contas pagas, vencidas e pendentes.<br>- Filtros funcionam conforme seleção.<br>- Atualização ocorre sem precisar recarregar a página. | - Utilizar gráficos ou cores para facilitar interpretação.<br>- Sincronizar estado com marcação de pagamento (US019). |
| **US019** | Marcação Manual de Contas Pagas | Como usuário, quero marcar contas como pagas manualmente. | - Controle direto sobre as contas.<br>- Ao marcar como paga, a planilha registra a data e o evento no calendário é removido ou atualizado. | 1. Oferecer botão ou checkbox para marcar pagamento.<br>2. Registrar data e hora na planilha.<br>3. Cancelar ou modificar o evento do Calendar relacionado. | 1. Usuário marca a conta como paga.<br>2. Sistema salva a alteração e ajusta o lembrete. | - Desfazer disponível em caso de erro.<br>- Falhas são comunicadas ao usuário. | - Dados devem permanecer consistentes entre planilha e calendário. | - Indicação imediata da mudança de status. | - Sincronização via API Routes do Next.js com Google Calendar. |
| **US020** | E-mail de Lembrete de Vencimento | Como usuário, quero receber um e-mail um dia antes do vencimento da conta. | - Não esquecer de realizar o pagamento.<br>- Automatizar o aviso de vencimento. | 1. Agendar envio de e-mail após criação do evento no Calendar.<br>2. Mensagem deve conter nome da conta, valor, vencimento e link para a planilha.<br>3. Permitir configuração de horário do lembrete. | 1. Evento é criado no Calendar.<br>2. Sistema agenda o e-mail para 1 dia antes do vencimento.<br>3. Usuário recebe e-mail com as informações completas. | - Caso o e-mail falhe, registrar erro e avisar usuário na próxima interação.<br>- Possibilidade de reenvio manual. | - Utilizar serviço de e-mail confiável (Gmail API).<br>- Garantir privacidade das informações. | - E-mail chega com antecedência correta.<br>- Dados apresentados estão consistentes com a planilha.<br>- Link leva diretamente à conta correspondente. | - Armazenar registro do envio para consulta.<br>- Respeitar limites de envio da conta Gmail. |
