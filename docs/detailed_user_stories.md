# Detailed User Stories (US001–US006)

The following table expands the first six user stories with additional details such as goals, functional requirements and acceptance criteria.

| Código | Título | Descrição Geral | Objetivos e Benefícios | Requisitos Funcionais Detalhados | Fluxo Principal (Caminho Feliz) | Fluxos Alternativos e Exceções | Requisitos Não Funcionais | Critérios de Aceitação | Notas e Considerações Técnicas |
|---------|---------|----------------|---------------------|----------------------------------|--------------------------------|-------------------------------------------|--------------------------|----------------------------|----------------------------------|
| **US001** | Definir Nome da Planilha para Armazenamento de Contas | Como usuário, quero definir o nome da planilha para armazenar minhas contas, facilitando a organização e identificação dos dados. Se a planilha não existir, ela deve ser criada automaticamente. | - Organização personalizada do armazenamento de contas.<br>- Identificação clara da planilha utilizada.<br>- Redução de ambiguidades na gestão dos dados. | 1. Permitir que o usuário insira um nome personalizado para a planilha.<br>2. Se o campo for deixado em branco, sugerir e utilizar um nome padrão ("Minhas Contas").<br>3. Verificar a existência da planilha com o nome informado.<br>4. Caso a planilha não exista, criá-la automaticamente. | 1. O usuário acessa a interface do Agent Bill.<br>2. Clica na opção para definir o nome da planilha.<br>3. Insere um nome ou deixa o campo vazio.<br>4. O sistema valida a entrada.<br>5. Se vazio, utiliza o nome padrão "Minhas Contas".<br>6. Verifica se a planilha já existe.<br>7. Se não existir, cria a planilha automaticamente.<br>8. Exibe uma confirmação para o usuário. | - Se o usuário inserir um nome que já exista, o sistema poderá solicitar confirmação para usar a planilha existente ou sugerir a criação de uma nova.<br>- Se ocorrer um erro durante a criação, uma mensagem de erro deve ser exibida e uma nova tentativa deve ser permitida. | - Interface simples, intuitiva e responsiva.<br>- Validação e criação da planilha devem ocorrer rapidamente.<br>- Segurança e integridade dos dados.<br>- Compatibilidade com a API do Google Sheets. | - O sistema deve permitir a inserção de um nome para a planilha.<br>- Se o usuário não inserir um nome, o padrão "Minhas Contas" é utilizado.<br>- A planilha deve ser criada automaticamente se não existir.<br>- Feedback claro e imediato ao usuário sobre a ação realizada. | - Implementar a validação no cliente e no servidor.<br>- Gerenciar erros de autenticação com a API do Google Sheets.<br>- Permitir apenas usuários autenticados via Google OAuth.<br>- Realizar testes para cenários como nome vazio, nome existente e falhas de criação. |
| **US002** | Visualização Dinâmica da Planilha | Como usuário, quero visualizar o conteúdo da planilha para acompanhar quais contas já foram adicionadas, garantindo uma visão em tempo real do registro das contas processadas. | - Monitoramento em tempo real das contas registradas.<br>- Facilidade de verificação e controle das contas.<br>- Transparência no gerenciamento financeiro. | 1. Exibir a planilha na interface web do Agent Bill.<br>2. Atualizar os dados dinamicamente sem recarregar a página.<br>3. Permitir a navegação quando houver muitos registros.<br>4. (Opcional) Oferecer filtros e ordenação.<br>5. Organizar as informações em colunas bem definidas. | 1. O usuário acessa a interface web do Agent Bill.<br>2. A planilha é exibida automaticamente.<br>3. O usuário visualiza a lista completa de contas.<br>4. Sempre que ocorrer uma alteração, a planilha se atualiza dinamicamente. | - Se a atualização dinâmica falhar, exibir uma mensagem de erro e um botão para recarregar manualmente.<br>- Em caso de grande volume de dados, pode haver paginação ou rolagem infinita.<br>- Problemas de conexão com o Google Sheets geram um alerta ao usuário. | - Interface responsiva para diferentes dispositivos.<br>- Tempo de resposta mínimo para manter a sensação de "tempo real".<br>- Visualização acessível apenas a usuários autenticados.<br>- Desempenho otimizado mesmo com muitos registros. | - A planilha deve estar visível na interface em todos os momentos.<br>- Alterações devem ser refletidas dinamicamente e sem recarregar a página.<br>- Dados organizados de forma clara.<br>- Mensagens de erro adequadas devem ser exibidas em falhas de atualização. | - Pode-se utilizar polling ou WebSockets para a atualização em tempo real.<br>- A integração com o Google Sheets deve ser robusta.<br>- Testes de desempenho são essenciais para garantir fluidez.<br>- A experiência do usuário deve ser priorizada. |
| **US003** | Prevenção de Duplicação de Contas | Esta funcionalidade permite que o sistema verifique automaticamente se uma conta já existe na planilha, evitando duplicações indesejadas e notificando o usuário quando isso ocorrer. | - Garantir que cada conta seja registrada apenas uma vez.<br>- Evitar pagamentos duplicados.<br>- Manter a planilha organizada e sem redundâncias.<br>- Economizar tempo e aumentar a confiabilidade dos dados.<br>- Reduzir a necessidade de limpeza manual de duplicatas. | 1. Verificar duplicatas antes de adicionar uma conta.<br>2. Considerar código de barras como identificador principal.<br>3. Se não houver código de barras, usar combinação de nome, cedente e vencimento.<br>4. Exibir notificação clara sobre a duplicata detectada.<br>5. Oferecer opções ao usuário: cancelar, atualizar existente ou forçar inserção.<br>6. Registrar em log as tentativas de duplicata. | 1. O usuário seleciona um arquivo de imagem ou PDF com dados de uma conta.<br>2. O sistema processa o arquivo e extrai as informações relevantes.<br>3. O sistema verifica se existe uma conta com o mesmo código de barras.<br>4. O sistema verifica se existe uma conta com a mesma combinação de nome, cedente e vencimento.<br>5. Se não houver duplicatas, os dados são exibidos para confirmação.<br>6. O usuário confirma a adição da conta.<br>7. O sistema adiciona a conta na planilha.<br>8. Uma mensagem de sucesso é exibida. | 1. Duplicata por código de barras: após o passo 3, o sistema detecta a duplicata, exibe os detalhes e oferece opções (Cancelar, Atualizar Existente ou Adicionar como Nova).<br>2. Duplicata por nome, cedente e data: após o passo 4, exibe notificação e oferece as mesmas opções.<br>3. Falha na extração do código de barras: o sistema avisa que a verificação ocorrerá apenas pelos campos nome, cedente e vencimento. | - A verificação deve ocorrer em menos de 2 segundos mesmo com centenas de registros.<br>- Notificações claras e visíveis.<br>- Manutenção da integridade dos dados em operações simultâneas.<br>- Compatível com o formato do Google Sheets.<br>- Código documentado para futuras alterações. | - Verificar se a conta já existe considerando o código de barras.<br>- Usar campos secundários quando não houver código de barras.<br>- Notificar a duplicata com dados para comparação e ações do usuário.<br>- Registrar em log todas as tentativas de duplicata.<br>- Funcionar adequadamente em planilhas com ao menos 1000 registros. | - Implementar a lógica de verificação de duplicatas no Google Apps Script.<br>- Criar um índice em memória para otimizar buscas.<br>- Dependência direta com as histórias US004 a US008.<br>- Normalizar textos antes de comparar e considerar funções de similaridade.<br>- Registrar logs em aba separada ou planilha de logs.<br>- Tornar as funções modulares para atualizações futuras.<br>- Ignorar diferenças de formatação em valores monetários.<br>- Interface de notificação integrada ao Google Sites.<br>- Verificar dados extraídos pela API OpenAI Vision. |
| **US004** | Seleção de Arquivo para Processamento de Conta | Como usuário, desejo selecionar um arquivo (imagem ou PDF) a partir do meu computador para que o Agent Bill processe os dados da conta contida no arquivo. Essa funcionalidade é essencial para a extração automática de informações de boletos e faturas. | - Facilitar a entrada de dados por meio de arquivos digitalizados.<br>- Integrar a seleção ao fluxo de extração de dados, reduzindo erros.<br>- Garantir uma experiência de usuário intuitiva. | 1. Interface deve ter botão "Selecionar Arquivo" abrindo o seletor do sistema.<br>2. Aceitar apenas arquivos PNG, JPG e PDF, validando imediatamente o formato.<br>3. Após validação, enviar o arquivo para a API OpenAI Vision e exibir mensagem "Processando arquivo".<br>4. Tratar erros: formato inválido gera aviso; cancelamento de seleção não inicia processo. | 1. Usuário clica em "Selecionar Arquivo".<br>2. Seleciona um arquivo PNG, JPG ou PDF.<br>3. O sistema valida e envia para a API.<br>4. O usuário é informado que o arquivo está sendo processado.<br>5. O fluxo continua até a extração e confirmação dos dados. | 1. Formato inválido: exibir mensagem e permitir nova tentativa.<br>2. Cancelamento da operação: retornar à interface principal sem validar ou enviar o arquivo. | - Interface intuitiva e responsiva.<br>- Validação rápida do formato do arquivo.<br>- Envios para a API otimizados.<br>- Transmissão segura dos arquivos. | - O sistema deve aceitar apenas PNG, JPG e PDF.<br>- Em formato inválido, mostrar erro claro com os formatos suportados.<br>- Após um arquivo válido ser escolhido, exibir feedback visual de processamento.<br>- O arquivo deve ser enviado para a API OpenAI Vision para extração dos dados. | - Validar formato no cliente e no servidor.<br>- Testar em diferentes navegadores e dispositivos.<br>- Mensagens claras devem orientar o usuário em cada etapa.<br>- Integração com a API de extração e Google Sheets deve ser testada com atenção. |
| **US005** | Extração Automática de Informações da Conta | Como usuário, quero que o agente extraia automaticamente os dados da conta a partir do arquivo selecionado (imagem ou PDF), evitando digitação manual. | - Automatizar a captura de dados de boletos e faturas.<br>- Reduzir erros e tempo de processamento.<br>- Integrar os dados extraídos com a planilha e calendário. | 1. Enviar o arquivo para a API OpenAI Vision.<br>2. Extrair nome da conta, cedente, tipo, valor, data de vencimento e código de barras.<br>3. Solicitar confirmação manual caso algum dado esteja ilegível ou ausente. | 1. Usuário seleciona o arquivo da conta.<br>2. O sistema envia para a API e aguarda resposta.<br>3. Os dados extraídos são apresentados para revisão.<br>4. Usuário confirma para prosseguir com as próximas etapas. | - Dados faltando: o sistema marca campos faltantes e solicita preenchimento manual.<br>- Erro na API: exibir mensagem e permitir nova tentativa ou escolha de outro arquivo. | - Processamento deve ocorrer em poucos segundos.<br>- Segurança no envio e armazenamento dos dados.<br>- Compatível com arquivos variados em tamanho e qualidade. | - O sistema retorna todos os campos extraídos ou indica claramente os que precisam de correção.<br>- O usuário consegue editar manualmente dados faltantes.<br>- Após confirmação, os dados seguem para validação de duplicidade (US003). | - A integração com OpenAI Vision deve ser implementada em Google Apps Script.<br>- Logs de falha de extração devem ser registrados em planilha dedicada.<br>- Considerar tratamento de caracteres especiais e formatações. |
| **US006** | Confirmação Manual dos Dados Extraídos | Como usuário, quero visualizar e editar os dados extraídos antes de confirmá-los para que apenas informações corretas sejam salvas na planilha. | - Garantir que os dados sejam revisados antes do armazenamento.<br>- Permitir correção de erros de OCR.<br>- Aumentar a confiança do usuário no sistema. | 1. Exibir um formulário de revisão após a extração automática.<br>2. Permitir edição de todos os campos (nome, cedente, tipo, valor, vencimento e código de barras).<br>3. Validar os campos editados (formatos, valores, campos obrigatórios).<br>4. Disponibilizar botões para Confirmar ou Cancelar. | 1. A extração é concluída.<br>2. O sistema mostra os dados em tela.<br>3. O usuário revisa e, se necessário, edita campos.<br>4. Clica em Confirmar para prosseguir. | - Usuário cancela a operação: dados extraídos são descartados.<br>- Edição com campos inválidos exibe mensagem de erro e impede confirmação. | - Feedback visual imediato durante a edição.<br>- Interface intuitiva e responsiva.<br>- Tempo de resposta baixo entre edições e confirmação. | - Após a extração, o usuário sempre visualiza um resumo dos dados.<br>- É possível editar qualquer campo antes de confirmar.<br>- Se confirmado, o sistema segue para a verificação de duplicidade (US003). | - Formulário implementado em Google Sites.<br>- Validações adicionais em Google Apps Script.<br>- Alterações manuais devem ser registradas em log. |
